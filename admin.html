<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - Educação</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
    <style>
        /* CSS Extra para as Novidades */
        .bulk-actions-bar {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: #1e293b; color: white; padding: 15px 25px; border-radius: 50px;
            display: flex; gap: 15px; align-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 2000; animation: slideUp 0.3s;
        }
        .hidden-bar { display: none !important; }
        .load-more-container { text-align: center; margin-top: 20px; padding-bottom: 20px; }
        .password-wrapper { position: relative; }
        .password-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; color: #94a3b8; }
    </style>
</head>
<body>

    <!-- TELA DE LOGIN -->
    <div id="login-screen" class="login-container">
        <div class="card login-card">
            <div class="brand" style="margin-bottom: 20px;">
                <i class="fa-solid fa-user-shield" style="color: var(--primary); font-size: 3rem;"></i>
            </div>
            <h2>Acesso Restrito</h2>
            <form onsubmit="realizarLogin(event)">
                <div class="input-wrapper password-wrapper">
                    <i class="fa-solid fa-lock" style="left:15px; z-index:1;"></i>
                    <input type="password" id="admin-pass" placeholder="Senha de Acesso" required>
                    <i class="fa-solid fa-eye password-toggle" onclick="toggleSenha()"></i>
                </div>
                <button type="submit" class="btn-primary" style="border-radius: 50px;">Entrar</button>
            </form>
        </div>
    </div>

    <!-- PAINEL -->
    <div id="admin-panel" class="hidden">
        <nav class="admin-nav">
            <div class="nav-brand"><i class="fa-solid fa-graduation-cap"></i> Admin</div>
            <div class="nav-links">
                <button class="nav-btn active" onclick="switchTab('tab-dashboard')"><i class="fa-solid fa-chart-pie"></i> Dashboard</button>
                <button class="nav-btn" onclick="switchTab('tab-eventos')"><i class="fa-regular fa-calendar"></i> Eventos</button>
                <button class="nav-btn" onclick="switchTab('tab-inscricoes')"><i class="fa-solid fa-users"></i> Inscrições</button>
                <button class="nav-btn" onclick="switchTab('tab-config')"><i class="fa-solid fa-gears"></i> Configurações</button>
            </div>
            <button class="logout-btn" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> Sair</button>
        </nav>

        <main class="admin-content">
            <!-- DASHBOARD -->
            <section id="tab-dashboard" class="tab-content active fade-in">
                <div class="header-action">
                    <h2>Visão Geral</h2>
                    <button onclick="carregarDashboard()" class="btn-refresh"><i class="fa-solid fa-rotate-right"></i></button>
                </div>
                <div class="stats-grid">
                    <div class="stat-card"><h3>Total Inscritos</h3><p id="stat-total">0</p><i class="fa-solid fa-users"></i></div>
                    <div class="stat-card"><h3>Aprovados</h3><p id="stat-aprovados" style="color:var(--success);">0</p><i class="fa-solid fa-check-circle"></i></div>
                    <div class="stat-card"><h3>Pendentes</h3><p id="stat-pendentes" style="color:var(--warning);">0</p><i class="fa-solid fa-clock"></i></div>
                </div>
                <div class="charts-container">
                    <div class="chart-box"><h4>Por Evento</h4><div style="height:300px;"><canvas id="chartEventos"></canvas></div></div>
                    <div class="chart-box"><h4>Por Status</h4><div style="height:300px;"><canvas id="chartStatus"></canvas></div></div>
                </div>
                <div class="report-section no-print">
                    <h3><i class="fa-solid fa-bus"></i> Gerador de Rotas</h3>
                    <div class="filters" style="border:none; padding:0; box-shadow:none;">
                        <select id="relatorio-evento"><option value="">Selecione o Evento...</option></select>
                        <select id="relatorio-inst"><option value="">Todas Instituições</option></select>
                        <button class="btn-primary" style="width:auto; margin-top:0;" onclick="gerarRelatorioTransporte()"><i class="fa-solid fa-print"></i> Gerar</button>
                    </div>
                </div>
                <div id="area-impressao"></div>
            </section>

            <!-- EVENTOS -->
            <section id="tab-eventos" class="tab-content hidden fade-in">
                <div class="header-action">
                    <h2>Gerenciar Eventos</h2>
                    <button class="btn-primary" style="width: auto; margin-top:0;" onclick="modalNovoEvento()"><i class="fa-solid fa-plus"></i> Novo</button>
                </div>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead><tr><th>ID</th><th>Título</th><th>Status</th><th style="text-align: right;">Ações</th></tr></thead>
                        <tbody id="lista-eventos-admin"></tbody>
                    </table>
                </div>
            </section>

            <!-- INSCRIÇÕES (Com Lazy Load e Bulk) -->
            <section id="tab-inscricoes" class="tab-content hidden fade-in">
                <div class="header-action">
                    <h2>Inscrições</h2>
                    <button onclick="carregarInscricoes()" class="btn-refresh"><i class="fa-solid fa-rotate-right"></i></button>
                </div>
                <div class="filters">
                    <select id="filtro-evento" onchange="resetEFiltrar()"><option value="">Todos os Eventos</option></select>
                    <select id="filtro-status" onchange="resetEFiltrar()"><option value="">Todos Status</option><option value="Pendente">Pendente</option><option value="Aprovada">Aprovada</option><option value="Rejeitada">Rejeitada</option></select>
                    <input type="text" id="filtro-nome" placeholder="Buscar..." onkeyup="resetEFiltrar()">
                </div>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" id="check-all" onclick="toggleAllChecks()"></th>
                                <th>Data</th><th>Evento</th><th>Candidato / Chave</th><th>Status</th><th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="lista-inscricoes-admin"></tbody>
                    </table>
                </div>
                <div class="load-more-container">
                    <button id="btn-load-more" class="btn-refresh" style="margin: 0 auto; display:none;" onclick="renderizarProximaPagina()">
                        Carregar Mais <i class="fa-solid fa-chevron-down"></i>
                    </button>
                </div>
            </section>

            <!-- CONFIG -->
            <section id="tab-config" class="tab-content hidden fade-in">
                <h2>Configurações</h2>
                <div class="config-grid">
                    <div class="card form-card">
                        <h3>Instituições</h3>
                        <div style="display:flex; gap:10px; margin-top:15px;">
                            <input type="text" id="nova-inst" placeholder="Nome" style="flex:1;">
                            <button class="btn-primary" style="width:auto; margin-top:0;" onclick="addInstituicao()"><i class="fa-solid fa-plus"></i></button>
                        </div>
                        <div id="lista-instituicoes" style="margin-top:15px; max-height:300px; overflow-y:auto; border:1px solid #eee;"></div>
                    </div>
                    <div class="card form-card">
                        <h3>Banco de Dados</h3>
                        <a href="#" onclick="window.open('https://docs.google.com/spreadsheets/u/0/', '_blank')" class="btn-primary" style="background:#10b981; text-decoration:none; text-align:center; margin-top:15px;">Acessar Planilha</a>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- BARRA FLUTUANTE DE AÇÃO EM MASSA -->
    <div id="bulk-bar" class="bulk-actions-bar hidden-bar">
        <span><strong id="bulk-count">0</strong> selecionados</span>
        <button class="action-btn" style="background:#22c55e;" onclick="acaoEmMassa('Aprovada')" title="Aprovar Selecionados"><i class="fa-solid fa-check"></i> Aprovar</button>
        <button class="action-btn" style="background:#ef4444;" onclick="acaoEmMassa('Rejeitada')" title="Rejeitar Selecionados"><i class="fa-solid fa-xmark"></i> Rejeitar</button>
        <button class="action-btn" style="background:#64748b;" onclick="desmarcarTudo()" title="Cancelar"><i class="fa-solid fa-minus"></i></button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="admin.js"></script>
</body>
</html>
